Автор: ereinion
Дата: 2021-09-25T09:06:06.000Z
Название: Она могла стать Первой: история процессорной архитектуры Alpha (часть
3)
Теги: Блог компании Selectel, Компьютерное железо, История IT, Старое
железо, Процессоры
Текст:
Уверен, поклонники серии ждали с нетерпением! Не будем тянуть, пора
продолжить наш мини-сериал. В предыдущих сериях (часть 1, часть 2) мы
познакомились с первым и вторым поколением Digital Alpha, теперь же
перед нами модель 21264 — основная и единственная линейка третьего
поколения архитектуры и нам пора окунуться во все тяжкие!   Третье
поколение было объявлено в 1996 году, всего через год после того, как
второе стало доступно на рынке. Однако только в феврале 1998 года,
незадолго до краха Digital, первые процессоры стали появляться в
кремнии. К тому моменту своих фабрик у нее уже не осталось — согласно
условиям сделки, процессоры выпускались на фабрике Intel Fab6, ранее
принадлежавшей Digital.   Часть процессоров выпускалась на мощностях
Samsung, которая стала не только партнером по выпуску, но и
лицензировала архитектуру. Всего через четыре месяца, остатки Digital
перешли под контроль Compaq, и первые машины на Alpha 21264/EV6 вышли
уже под брендом нового владельца.   Оставшись на прежнем, 0.35 мкм
техпроцессе, ядро EV6 получило значительно переработанную
микроархитектуру. Количество транзисторов достигло 15.2 миллиона при
площади кристалла 314 мм2. Сильно возросло энергопотребление — до 73
Вт. Самым важным изменениям стало внедрение механизма внеочередного
исполнения команд, причем с возможностью переименования регистров.
Микроархитектура процессора Alpha 21264. Источник   Также появились
дополнительные новые инструкции, вырос до 128 Кбайт кэш L1. Кэш L2
остался внешним и все также для подключения использовал выделенную
128-битную шину, частота задавалась делителем — от ⅛ до ⅔ от частоты
ядра, поддерживались микросхемы SSRAM (синхронная статическая память
произвольного доступа) и DDR SSRAM. Внешняя шина (FSB) осталась
64-битной (плюс 8 бит для ЕСС), но впервые была внедрена технология
DDR (та самая Double Data Rate), при которой данные передавались
дважды за такт — по фронту и спаду тактового сигнала.  Alpha + AMD = ?
Новая системная шина стала важнейшей вехой в развитии Alpha, она могла
дать ей, наконец, дорогу в мир ПК. Одной из причин высокой стоимости
готовых Alpha-систем были сложные (и быстрые, конечно!) чипсеты, к
тому же выпускаемые небольшими тиражами. Очень нужны были недорогие и
массовые, пусть и более скромные в своих возможностях, платформы.
«Родные» чипсеты 21272 (Tsunami, до 2 CPU) и 21274 (Typhoon, до 4 CPU)
оставались многочиповыми решениями. Минимальный набор состоял из
четырех чипов, не считая стороннего южного моста.   Еще при жизни
Digital, AMD приобрела лицензию на шину еще находящегося в разработке
EV6, чтобы использовать ее своих грядущих Athlon. И, к счастью, AMD
применила ее практически без изменений. Alpha использовала 166 и 200
МГц варианты, а AMD — 200 и, в дальнейшем, 266 и более высокие
частоты. Таким образом, вышедшие для Athlon чипсеты AMD 750 «Irongate»
и AMD 760 «Irongate II» стали общими для EV6 и Athlon. Адаптировать
свои чипсеты для работы с Alpha была готова и VIA, но для того должна
была быть воля Compaq. Увы, руководство Compaq не увидело потенциала
ни в недорогих Alpha, ни даже в рабочих станциях.   Рабочие станции
Compaq выпустил по остаточному принципу — теперь это были просто
младшие модели серверов с установленными видеоадаптерами и звуковыми
картами. Таковы, например, были AlphaStation XP900/DS10. Единственным
исключением стала AlphaStation XP1000, базирующаяся на старом шасси
времен Digital (такое же использовалось в Digital Celebris GL).
Свернуто было производство материнских плат для сторонних сборщиков.
Более того, в поколении 21264 не было даже упрощенных версий для
AlphaPC. Compaq упустила значительный кусок рынка, но это была лишь
одна из многих ошибок, приведших компанию к поглощению Hewlett-
Packard.   Здорово подкосил позиции Alpha отказ Compaq от участия в
разработке Windows NT для Alpha в 1999 году, на этапе, когда Windows
2000 была уже на стадии Release Candidate. Пусть доля Windows NT на
платформе была не так и велика, именно эта система кардинально влияла
на проникновение Alpha в нижние (для нее) сегменты рынка. Windows 2000
для Alpha так и не была выпущена, оставшись на долгое время доступной
только для платформ Intel — х86 и Itanium.   Но кроме Compaq,
оставалась еще одна движущая сила — Samsung. Компания выпускала не
только процессоры, но и разрабатывала и производила материнские платы
для них. Более того, в 1999 году большая часть бизнеса, связанного с
Alpha была выделена в созданную совместно с Compaq компанию Alpha
Processor Inc., API. Samsung и API использовали как традиционные
чипсеты Compaq (например, двухпроцессорная серверная плата UP2000),
так и чипсеты AMD, подходящие для однопроцессорных плат. Таковы были
UP1000 и UP1100.    Самой желанной для энтузиастов стала UP1500 —
единственная, использовавшая северный мост AMD 761. Эта плата
поддерживала память DDR SDRAM объемом до 4 Гбайт, и благодаря вдвое
большей в сравнении обычной SDRAM производительности, подсистема
памяти этой платы не становилась бутылочным горлышком (это касается
исключительно плат на AMD 750 — платы на Typhoon/Tsunami использовали
128/256 бит интерфейс SDRAM, соответствующий потребностям процессора).
Еще одним приятным бонусом было наличие у этих плат слота AGP. Что
интересно, в качестве южного моста использовались микросхемы ALi, а не
обычно сопутствующие AMD 750/760 мосты VIA 686.  Сказал «А», скажи и
«B»  Первые процессоры AMD Athlon использовали разъем Slot A. Такой
форм-фактор имел определенную популярность в 1997-2000 годах, когда
кэши выросли и переехали поближе к ядру процессора, но технологии были
еще не готовы к тому, чтобы разместить кэш достаточного объема на том
же кристалле. Общим для большинства процессоров в слотовом исполнении
было расположение кэш-памяти в виде отдельных микросхем рядом с
основной микросхемой процессора.   Исключением стали только поздние
Pentium III «Coppermine» и Xeon «Cascades», которые получили кэш на
кристалле, но продолжили использовать старый форм-фактор. Некоторые
версии Xeon также несли на огромных размеров процессорной плате еще и
модуль питания, VRM.   Итак, Slot A. Краткий опрос в среде энтузиастов
ретрокомпьютинга показал, что большинство считает — в этом обозначении
буква А отмечает принадлежность разъема компании AMD. И лишь немногие
знают, что был также и Slot B. В исполнении Slot B выпускались
процессорные модули для установки в платы UP1000 и UP2000.    Модуль
сочетал в себе процессор 21264, установленный в плату без
использования сокета (к сожалению, не удалось подробных фото, где было
бы понятно была это BGA версия или просто припаянный к плате процессор
с ножками), кэш память и VRM. Более того, согласно изначальным планам
процессоры в таком исполнении должна была выпустить и AMD, вероятно
это должен был быть некий ответ Intel Xeon, но и эти планы так и не
были реализованы.    Лишь в 2001 году были объявлены процессоры Athlon
MP и чипсет AMD 760MP с двумя шинами EV6. Плат на его основе для Alpha
не последовало, а Athlon MP выпускался в том же Socket A (462), что и
обычные Athlon тех лет.  Развитие или стагнация?  Как вы помните,
Alpha всегда выделялась очень высокими для своего времени частотами. К
концу двадцатого века, в результате гонки частот Intel и AMD и
постепенного свертывания разработки архитектуры со стороны Compaq этот
тренд прекратился. EV6 с частотой 466-600 МГц были не быстрее (речь
только о частотах) предыдущего поколения.   Уже в 1999 году появились
обновленные 21264А (EV67), выпускашиеся по 0.25 мкм технологии.
Площадь кристалла сократилсь до 210 мм2, а частоты возросли до 600-750
МГц. Кроме die-shrink изменений это обновление не принесло. Что
интересно, продававшийся как 600 МГц процессор на самом деле работал
на 618 МГц. В том же 1999 Pentium III работал уже на 733 МГц, частоты
практически сравнялись. А в 2000 году, Intel и AMD достигли частоты 1
ГГц.   В 2000 году появились 21264B (EV68) с частотами 800-833 МГц
(0.18 мкм), но только в 2001 c появлением 21264С (также EV68) удалось
достичь 1.25 ГГц, так и оставшихся финальными. Начиная с этой версии
изменился сокет, вместо прежнего классического PGA с 587 контактами
стал использоваться 675-контактный LGA. Для некоторых моделей серверов
процессоры устанавливались на процессорные модули, но
стандартизированы они не были, имя Slot C не появилось.   Упоминается
также и 21264D, с частотами аналогичными предыдущей версии. Точные
отличия этой версии от предыдущих неизвестны.   В 2001 году Compaq
было очень плохо. Обвал рынка ценных бумаг интернет-компаний, более
известный как крах доткомов и неэффективное управление привели
компанию на грань банкротства. В 2002 году произошло объединение с HP,
которое де-факто было поглощением. У большинства унаследованных от
Compaq продуктов были аналоги в линейках HP. К чести последней, не
весь модельный ряд Compaq был свернут, часть линеек была интегрирована
в новый модельный ряд или даже заменила разработки HP.   Так ушли с
рынка самобытные NetServer и Omnibook. Compaq’овские ProLiant и Evo
были более мейнстримовыми, но и более совершенными — они и выжили в
корпоративной борьбе. HP AlphaServer продолжили свое существование бок
о бок с HP9000 и грядущими Integrity…  Очень милый сервер  Долгое
время в коллекции Digital Vintage не было ни одной «Альфы». Поиски
были долгими, а появление такой машины летом этого года — счастливой
случайностью. Я хотел приобрести рабочую станцию IBM, но пока вел
переговоры с продавцом меня опередили. Других объявлений у продавца не
было, но я на удачу поинтересовался, есть ли еще что-то интересное. И
получил ответ — «Альфа». Раздумывать долго не пришлось!
Представитель третьего поколения Alpha, попавший мне в руки — сервер.
Сервер, выглядящий очень миловидно и до конца не определившийся кто же
он такой — в зависимости от установленных плат расширения, он может
быть как сервером, так и рабочей станцией. Его имя — AlphaServer DS10,
но также он известен как AlphaStation XP900 и AlphaStation DS10. Наш
экземпляр маркирован именно как сервер, но в нем установлена младшая
из доступных для него видеокарт — 3DLabs Permedia 2 с 4 Мбайт
видеопамяти.    Компанию ей составляет звуковая карта Ensoniq
AudioPCI, согласно каталогу Compaq именно такая и положена. При этом
на борту присутствует два сетевых интерфейса (10/100 мбит/сек), а
последовательный порт может использоваться для подключения консоли.
Для сервера у DS10 очень непривычный форм-фактор. Это… десктоп.
Красивый темно-синий десктоп форм-фактора NLX — в материнскую плату
устанавливается плата-«елка» и в нее уже вставляются платы расширения.
Боковые стенки и верхняя крышка снимаются отдельно и выполнены из
шершавого, очень приятного на ощупь прочного пластика, с внутренней
стороны к ним прикреплены экранирующие пластины. Ширина корпуса
соответствует 19” стойке, высота — 3U, тонкие серверы в 1999 были еще
в новинку.    Такая машина может стоять на столе у разработчика — она,
кстати, довольно тихая, а может и в стойке — как на полке, так и, в
специальном исполнении, на привычных сегодня направляющих-рельсах.
Кодовое имя модели, WebBrick, очень хорошо указывает на основное
применение этих машин. Кстати, существовала и 1U версия — DS10L с
меньшими возможностями расширения.   По ширине корпус также
соответствует классическом десктопу Inwin H500, что навевает мысли о
том, что полка в стойке будет уютным домом и для него. Вот только
Inwin’у потребуется на один юнит больше. DS10 при меньшей высоте также
имеет два отсека для 5.25” устройств (а вот внешний отсек для 3.5”
девайсов один, и его более чем достаточно) — в нашем случае в нем
расположены CD-ROM (эти машины комплектовались IDE приводом) и
«сказевый» стример формата DDS-4 (20/40 Гбайт).    Компанию им
составляет обыкновенный 3.5” дисковод. Опционально могла
устанавливаться занимающая оба отсека корзина для двух дисков SCSI
SCA, поддерживающая горячую замену. В оставшемся узком пространстве
над ними помещался тонкий «ноутбучный» CD-ROM.   Серверы в подобных
корпусах — великая редкость. Мне известны лишь ранние модели HP
NetServer с 486 процессором и AlphaServer DS10/DS15. Возможно,
небольшие компании могли собирать серверы и в корпусах типа H500, но
вряд ли это было сколько-нибудь распространенной практикой ввиду
скромных возможностей по размещению дисковых подсистем.   Внутри
корпуса скрывается фирменная материнская плата с одним разъемом Socket
587, в который в данном экземпляре установлен процессор EV67 с
частотой 618 МГц (маркетинговое обозначение 600 МГц). Плата построена
на чипсете Tsunami с южным мостом ALi. Оперативная память
устанавливается в 4 слота SDRAM, максимальный ее объем 2 Гбайт — здесь
он и достигнут. Требуется память стандарта не менее PC100, но
фактически она работает на частоте 83 МГц. Интерфейс памяти —
128-битный, модули устанавливаются парами.   На плате не установлен
контроллер SCSI — базовые версии DS10 обходились IDE дисками. В нашем
случае SCSI реализован отдельным двухканальным контроллером Adaptec
39160 (установлена оригинальная плата с маркировкой HP — наша машина
выпущена уже после слияния, в конце 2002 года). К первому каналу
подключен основной жесткий диск — максимальный, согласно каталогу, 73
Гбайтный с интерфейсом Ultra160 SCSI и скоростью вращения шпинделя
10000 RPM. Диск быстрый и на удивление весьма тихий.   У контроллера
есть и внешние разъемы, так что на второй канал можно повесить
стример, ленточную библиотеку или дисковую полку. Из перечисленного в
комплекте с машиной мне досталась оригинальная полка для SCSI дисков с
несколькими 9 и 18 Гбайт накопителями. Она выполнена в том же цвете,
что и сервер и отлично дополняет его. Полка довольно старой модели и
выпускалась еще во времена Digital, о чем говорит тот факт, что один
из блоков питания несет лого старой компании, а два — уже новой.
Блок питания очень похож на АТХ, но фактически плата не поддерживает
управлением питанием. При завершении работы ОС отключение питания не
происходит, вместо этого управление системой передается SRM.
Аналогичное действие выполняет кнопка Halt, заменяющая Reset. Причем
ее функцию можно изменить на Reset установкой джампера — это сделано
для работы под управлением Windows NT.   Большинство Alpha-машин
требовали перепрошивки для использования ARCBIOS и установки Windows
NT. Лишь некоторые имели две прошивки сразу. В DS10 достаточно набрать
в консоли SRM команду «arc» (или переключить режим работы в «NT») и
можно работать ОС, требующими ARC прошивку.   ARCBIOS        Первичная
загрузка также выполняется SRM, причем возможно настроить систему как
на автоматический запуск ОС с устройства по умолчанию, так и на ручной
старт из консоли SRM. Таким образом можно реализовать мультизагрузку,
установив на каждый подключенный жесткий диск свою ОС.  ТруЪ ЮниксЪ
Среди прочего, Compaq унаследовала от Digital и разработанные ею
операционные системы — OpenVMS и Digital Unix. Обе были весьма
популярны — Digital Unix устанавливалась на 65% выпускаемых на тот
момент Alpha-систем, а OpenVMS хоть и занимала около 30%, но считалась
незаменимой в целом ряде применений. Обеим повезло — Compaq был
заинтересован в их развитии, вот только имя бывшего конкурента
мозолило глаза руководителям компании. Так Digital Unix начиная с
версии 4.0F стала Tru64 Unix, что отражало нативно 64-битную природу
системы.    Согласно идентификатору моего DS10, он поставлялся именно
с Tru64 Unix версии 5.1, так что именно эту систему было решено
выбрать для установки (а еще я пока не разобрался с OpenVMS).
Установка довольно проста — загружаемся с CD-ROM, выбираем требуемый
набор компонентов, разбивку диска, устанавливаем базовые настройки.
При установленной видеокарте все это происходит в графическом режиме.
Установка длится 40 минут и система сразу готова к работе.   Первым
делом, нас встречает классическая оболочка CDE. Бывшая прорывом в
середине девяностых, в начале XXI века, она смотрится все еще приятно,
но устаревание уже чувствуется. Набор ПО в комплекте небольшой, только
самое необходимое — утилиты и браузер. По умолчанию установлен
Netscape 4 и Netscape 6. Возможно установить Mozilla Firefox 1.5.   На
втором диске комплекта идут важные дополнения — мультимедийные службы,
драйверы звуковых карт и 3D-ускорителей PowerStorm. На дополнительных
дисках — утилиты с открытым исходным кодом, что крайне важно, пакетный
менеджер RPM и окружение для работы Linux-программ. Пакетов в
комплекте немного, еще некоторое количество доступно в интернете. Так
я получил несколько простых игр, Xpaint, VNC и самое полезное —
OpenOffice.   В целом, с софтом и поддержкой современных форматов
файлов довольно грустно. Фон рабочего стола — XPM. Музыка — WAV.
Большинство настроек оболочки (к консольному ПО претензий нет)
выполняется через редактирование файлов конфигурации, даже настройки
разрешения и частоты обновления экрана. Главной болью для меня лично
стало отсутствие аналога Midnight Commander и проигрывателя MP3. Так я
задался целью обеспечить себя этими необходимыми для комфортной жизни
удобствами.    К счастью, в комплект системы входит компилятор, плюс
среди GNU-утилит есть и gcc. С коммандером проблем не возникло — он
собрался с первого же раза (я брал относительно старую версию 2017
года) и разве что упорно не хотел работать в цветном режиме. Пришлось
сделать скрипт-обертку, который добавляет ключ принудительного
цветного режима и передает остальные параметры при необходимости.   В
качестве плеера был выбран весьма старый XMMS. Причина тому проста —
он умеет выводить звук с помощью EsounD, Enlightened Sound Daemon. Это
единственный доступный вариант для Tru64 из относительно
распространенных. Другой вариант — штатная подсистема мультимедиа (в
нее по факту и перенаправляется звук), но для нее плеер пришлось бы
писать с нуля самостоятельно.    Сборка стала испытанием для моего
терпения — в обычной жизни мне не приходится этим заниматься вообще, а
тут потребовалось удовлетворить множество зависимостей из обоих миров
— Unix и Linux, а потом еще и внести немного правок в скрипт сборки.
Так или иначе — спустя полночи у меня уже играл в наушниках старый
добрый Nightwish. XMMS не разочаровал.    Приятным дополнением
оказалась возможность использовать привычные скины от WinAMP. Но
нашлись и минусы — не работает режим Shuffle, программа просто
вылетает — с этим еще предстоит разобраться. Не нравится работа
эквалайзера — при включении сильно возрастают искажения. Но это уже не
столь важная функция.   Итак, теперь система вполне подходит для жизни
при тяжелых приступах ностальгии. Загрузка занимает не больше пары
минут, после загрузки работает субъективно очень быстро. Большинство
программ запускаются мгновенно, за исключением браузера, офисного
пакеты и плеера. А уровень погружения в период — кажется улетает
далеко за 100%. Можно слушать музыку, работать с документами и даже
ходить в интернет.    В основном, конечно, на сайты ретротематики —
функционала браузера и производительности на современные сайты хватает
с трудом. При этом по ощущениям, работать в интернете на Альфе
комфортнее, чем на более свежих Pentium 4 с частотой 2.4 — 3 ГГц. Но
это снова субъективное ощущение. Тестов производительности я не
выполнял.    Моим главным опасением было разочарование, к счастью
этого не случилось. Эта машина действительно великолепно
сконструирована и в сравнении с ПК довольно необычно. Одна только
консоль SRM вместо BIOS стоит многого. Я довольно плотно работал с
этой машиной в течении месяца и получил массу удовольствия. Сейчас она
установлена на стенде с моими любимыми сборками из мира х86 и
подключена к KVM, чтобы можно было в любой момент получить требующуюся
дозу ностальгии. Ее соседями стали уже знакомые моим читателями
двухпроцессорные сборки с Pentium Pro и Pentium III Xeon и пара более
скромных ностальжи-машин.  Заключение  Третье поколение архитектуры
стало вершиной развития Alpha и началом конца. Постепенный отказ от
создания рабочих станций и полное сворачивание программы AlphaPC
сначала ограничили архитектуру развитием исключительно на серверном
рынке, а потом столкнув во внутренней конкуренции сначала с Itanium,
на который Compaq возлагала большие надежды, а потом еще и с PA-RISC —
родным детищем HP, на замену которому и готовился совместными силами
Itanium. Кто уйдет первым — вы узнаете из следующей части статьи.
Подготовлю сразу, happy end не грозит никому из упомянутых.    До
новых встреч!
