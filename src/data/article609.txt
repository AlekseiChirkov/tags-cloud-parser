Автор: mbps54
Дата: 2021-09-27T12:30:13.000Z
Название: Карго-культ в сетевой инфраструктуре
Теги: Блог компании Timeweb, Сетевые технологии *, Сетевое оборудование
Текст:
Сегодня предлагаю обсудить, действительно ли нам всегда так необходимы
те технологии, которые активно продвигаются производителями сетевого
оборудования для достижения маркетинговых парадигм (scalability,
flexibility, high availability, efficiency и далее по списку из
презентаций), и если все же необходимы, то в каких случаях. Зачастую,
при виде двух коммутаторов ядра сразу возникает образ их стекирования
/ виртуализации. Давайте разберемся!   Страшилка N1: STP обязательно
наделает петель и все сломается  У больших и известных производителей
сетевого оборудования есть свои проприетарные технологии объединения
коммутаторов (стекирование / виртуализация), и эти технологии призваны
упростить администрирование сети, повысить отказоустойчивость.
Разберемся так ли это.  Администрирование крупной сети с большим
количеством коммутаторов приводило к трудностям с протоколом семейства
STP, сложностью администрирования, и общей запутанностью в сети. На
помощь пришли технологии виртуализации коммутаторов: VSS — Cisco
Virtual Switching System, IRF — HPE Intelligent Resilient Framework и
другие.   Думаю, что читатель хорошо знаком со всеми плюсами, поэтому
приведу информацию кратко:  управление не двумя физическим
коммутатором, а одним логическим, что существенно проще; порты от
разных коммутаторов можно объединить в один MLAG, что тоже облегчает
администрирование и упрощает дерево STP.    А вот минусы подкрались
незаметно, и о них поговорим подробно:   зависимость от производителя:
если сломается один коммутатор, то при замене коммутатора на
устройство другого производителя придется отказываться от технологий
виртуализации и провести серьезную работу по переделыванию сети;
процедура обновления ПО: нет возможности обкатать разные версии ПО
одновременно. Если в неком ПО есть подозрение на баг, то нельзя только
один коммутатор апгрейдить или даунгрейдить на другую версию;
усложнился процесс замены вышедшего из строя коммутатора: тут не
достаточно просто заменить один коммутатор на другой, нужно выровнять
версии ПО, и привлекать к работам сетевого инженера, чтобы объединить
коммутаторы в один виртуальный.   А так ли страшно упрощение
администрирования и усложнение дерева STP?  В базовую программу
сертификации в сетях CCNA уже добавлены методики автоматизации сети,
стоит ли переживать об увеличении количества логических узлов в сети,
если больше нет надобности заходить на оборудование по SSH, чтобы
выполнить некие рутинные операции на сети? Различные методологии и
инструменты DevNetOps позволяют перенести администрирование сети на
новый уровень, от автоматизации рутинных задач скриптами до
декларативного описания сети (IaaC), в таком случае увеличение
количества коммутаторов не столь существенно усложняет задачу
администрирования.   На практике, если в сети есть два коммутатора
ядра с поддержкой виртуализации, то они непременно будут объединены
сетевыми инженерами в один логический коммутатор — такая парадигма
сегодняшнего дня.  Парадигма стекирования  Есть устойчивое и
обоснованное мнение, что без стекирования коммутаторов доступа будет
так много логических устройств, что администрировать сеть станет
невозможно, плюс существенно возрастут траты на СКС. Давайте
разбираться.   С одной стороны, стекирование коммутаторов доступа
упрощает администрирование, снижает затраты на СКС, но с другой
стороны, увеличивает риск останова сервиса для всех устройств,
подключенных к стеку по ряду причин:   возрастает критичность
коммутаторов с Uplink интерфейсами; возрастает критичность каждого из
линков, ведь теперь стандартные 2 Uplink-a обеспечивают сервис для
нескольких коммутаторов; сбой ПО на одном из коммутаторов может
привести к сбою всего виртуального коммутатора.   Тут вспоминается
фраза: “Быстро, дешево, качественно — выбрать любые два”.  Cisco Nexus
Технологии vPC и FEX у коммутаторов Cisco Nexus где-то посередине, там
нет общего control и management plane. Целевое предназначение
коммутаторов Cisco Nexus — высокодоступные сети ЦОДов, и это косвенно
указывает на то, что стекирование и виртуализация ведут к снижению
надежности. Таким образом, технологии Cisco Nexus позволяют упростить
дерево STP (использование vPC) и частично облегчить администрирование
(использование FEX), но при этом остаются вендор-зависимым решениями.
Итоги  Виртуализация и стекирование — это не обязательные к применению
технологии, в каждом конкретном случае надо выбирать наиболее
приемлемый вариант решения.    Подводя итоги, получается довольно
неожиданный вывод. Стекирование и виртуализация коммутаторов отлично
подходят для таких проектов, где:   нужно снизить стоимость
администрирования (кол-во портов тоже, но вот количество устройств
меньше, что все же упрощает работу); нужно снизить стоимость затрат на
СКС; допускаются риск простоя сервисов; выбранная линейка оборудования
будет на рынке еще достаточно долгое время; партнерские отношения с
выбранным производителем будут достаточно продолжительными.   Про Wi-
Fi: правый верхний квадрат Гартнера  Поговорим еще об одном аспекте
сетевых технологий, о беспроводной сети Wi-Fi. Как я смог заметить, в
большинстве проектов делается выбор на средние по производительности
точки доступа, но при этом идет борьба за каждую дополнительную точку
доступа. Не будет никакой выгоды в том, чтобы использовать средние или
старшие серии точек доступа, не обеспечив достаточно полное и
качественное радиопокрытие. Клиентскому устройству, которое принимает
сигнал от точки доступа на уровне -76дБ не будет никакой разницы,
насколько производительная точка доступа установлена и сколько там
одновременных пространственных потоков поддерживается: будет плохо и
медленно.   Принципиально, задачу построения Wi-Fi можно разделить на
две группы:   Достижение требуемой зоны покрытия (например, этажи с
номерами в гостинице, где нет высокой плотности клиентов) Достижение
требуемой емкости сети (например, конференц-зал или open space, где
требуется подключение к сети на высокой скорости для большого
количества участников)   Под задачу покрытия есть смысл выбрать
наименее производительные точки доступа, но в большем количестве. Для
задачи достижения высокой емкости (скорости) сети хорошо подойдут
высокопроизводительные точки доступа.
