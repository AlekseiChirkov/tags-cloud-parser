Автор: Zextras
Дата: 2021-09-24T13:00:02.000Z
Название: Как обновить Zimbra 9 OSE
Теги: Блог компании Zextras Technology
Текст:
Начиная с патча 15 основной разработчик Zimbra перестал загружать
обновленные пакеты в репозитории Open-Source версии. Из-за
пользователи сборки Zimbra 9 OSE от Zextras долгое время не могли
получить обновления привычным для них способом - через пакетный
менеджер при помощи команд yum update и apt upgrade, в зависимости от
дистрибутива GNU/Linux. Тем не менее, компания Zextras нашла способ
предоставить обновления своим пользователям в обход официальных
репозиториев и теперь пользователи Zimbra 9 OSE могут установить все
актуальные патчи. В данной статье мы подробно расскажем о том, как это
сделать.Суть нового способа получения обновлений заключается в том,
что все изменения, вносимые новыми патчами, теперь включаются в
кодовую базу установщика Zimbra 9 OSE и для того, чтобы обновить ваш
почтовый сервер, достаточно повторно выполнить процедуру его
установки, как это делалось ранее в случае перехода на новую версию
сервера.  Для того, чтобы обновить установленную Zimbra 9 OSE от
Zextras, необходимо пройти регистрацию и скачать свежую версию
установщика с сайта Zextras. В том случае, если вы уже скачивали
Zimbra 9 OSE ранее, то свежая сборка будет доступна по той же ссылке,
что и ранее. В нашем примере мы выполним обновление Zimbra 9 OSE,
установленной на ОС Ubuntu 18.04.Резервное копированиеВ том случае,
если вы являетесь пользователем Zextras Suite Pro или Basic,
рекомендуем в первую очередь перед началом всех действий, сделать
снэпшот системы. Для этого перейдем в консоль администрирования Zimbra
OSE, в нашем случае это https://mail.example.ru:7071 и в левой панели
перейдем в раздел Zextras - Backup. В нижней части страницы Zextras
нажмите на кнопку "Экспорт резервной копии".В открывшемся Мастере
экспорта нажмите "Далее".На следующем экране укажите путь, в котором
будет сохранен снэпшот системы. Убедитесь, что выбранный вами путь
существует, а у пользователя zimbra есть права на чтение и запись в
выбранную вами папку!  Нажмите "Далее"На следующем экране выберите
домены, которые хотите сохранить в резервной копии. Кликните на домен
и нажмите кнопку "Выбрать >", чтобы добавлять в снэпшот домены по
одному. Нажмите на кнопку "Выбрать все >>", чтобы добавить в снэпшот
сразу все домены. Нажмите кнопку "Далее", чтобы продолжить.На
последнем экране Мастера экспорта укажите электронную почту, на
которую хотите получить оповещение о завершении создания снэпшота
системы и нажмите на кнопку "Готово".Отобразится окно с информацией о
запуске создания снэпшота и информацией, необходимой для его
отслеживания. Нажмите кнопку "ОК", чтобы его закрыть. По окончании
создания снэпшота рекомендуется сохранить его на отдельном носителе,
после чего можно перейти к обновлению Zimbra 9 OSE.Обновление
ZimbraДля того, чтобы ее обновить, нужно перейти в папку со скачанным
ранее свежим дистрибутивом Zimbra 9 OSE и распаковать его с помощью
команды tar xvf zcs-9.0.0_OSE_UBUNTU18_latest-zextras.tgz.Перейдем в
папку с распакованным установщиком Zimbra 9 OSE и запустим установщик
Zimbra с помощью команды sudo ./install.shУстановщик автоматически
обнаружит ранее установленные элементы Zimbra OSE и предложит принять
лицензионное соглашение. Нажмите клавиши Y и Enter, чтобы согласиться
с ним.Далее установщик предложит проверить целостность базы данных
почтового хранилища. Также соглашаемся.Следующим этапом установщик
предложит подключить официальный репозиторий пакетов Zimbra, снова
соглашаемся.После проверки наличия пакетов в репозитории, установщик
спросит вас, хотите ли вы выполнить обновление. Отвечаем
согласием.После этого начнется процесс установки Zimbra OSE, в ходе
которого вам будет предложено доустановить те пакеты, которые не были
установлены в ходе начальной инсталляции Zimbra 9 OSE. В нашем случае
это zimbra-dnscache, zimbra-drive и zimbra-chat. Как и прежде, мы не
стали устанавливать ни один из этих пакетов. После этого установщик
предупредит, что в систему будут внесены изменения и спросит, хотите
ли вы продолжить установку. Отвечаем утвердительно.На время установки
обновленной версии, сервер Zimbra OSE будет остановлен. Все действия
по установке новых версий пакетов будут установлены автоматически.По
окончании установки вам будет предложено уведомить Zimbra о вашей
установке. Можете согласиться или не согласиться, так как итоговый
результат не будет от этого зависеть.После этого появится сообщение об
окончании установки. Чтобы завершить ее, нажмите Enter. По окончании
установки войдите в веб-клиент Zimbra OSE, чтобы убедиться в
работоспособности Zimbra OSE.Также можно воспользоваться командой
/opt/zimbra/libexec/zmdbintegrityreport -v, чтобы убедиться в том, что
данные во время обновления Zimbra OSE не пострадали.  В нашем случае,
в качестве хранилища файлов использовался быстрый NVMe накопитель. При
его использовании вся процедура обновления Zimbra OSE заняла не более
10 минут.Таким образом, после совершения всех этих действий сервер
Zimbra 9 OSE был обновлен до актуальной версии.По всем вопросам,
связанными c Zextras Suite и Team Pro вы можете обратиться к
Представителю компании «Zextras Technology» Екатерине Триандафилиди по
электронной почте ekaterina.triandafilidi@zextras.com.
